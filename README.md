# 目录文件浏览批处理脚本

## 概述

这是一个功能强大的Windows批处理脚本，用于递归浏览并显示当前目录下所有文件的结构和内容。该脚本提供了直观的树形结构展示，支持文本文件内容预览，并具有丰富的配置选项。

## 主要功能

- 🌳 **树形结构显示** - 以清晰的树形结构展示目录层次关系
- 📄 **文件内容预览** - 支持多种文件类型的内容预览
- 🔍 **智能文件分类** - 根据文件扩展名自动分类文件类型
- ⚙️ **灵活配置选项** - 支持命令行参数和配置文件
- 🔗 **交互式模式** - 提供用户友好的交互式操作界面
- 📊 **统计信息** - 显示文件和目录的统计数据
- 📝 **日志记录** - 记录操作历史和错误信息

## 系统要求

- Windows 7 或更高版本
- 支持批处理脚本执行
- 建议在命令提示符或PowerShell中运行

## 安装使用

### 快速开始

1. 下载 `directory-browser.bat` 脚本文件
2. 将脚本放置在需要浏览的目录中
3. 双击运行或在命令行中执行：

```cmd
directory-browser.bat
```

### 命令行参数

| 参数 | 简写 | 描述 | 默认值 | 示例 |
|------|------|------|--------|------|
| `--depth` | `-d` | 设置最大扫描深度 | 无限制 | `-d 3` |
| `--size` | `-s` | 显示文件大小信息 | true | `-s false` |
| `--hidden` | `-h` | 包含隐藏文件 | false | `-h true` |
| `--filter` | `-f` | 文件扩展名过滤器 | 无 | `-f "txt,log"` |
| `--preview` | `-p` | 启用内容预览 | true | `-p false` |
| `--interactive` | `-i` | 启用交互模式 | false | `-i` |
| `--help` | | 显示帮助信息 | | `--help` |

### 使用示例

#### 基本用法
```cmd
# 扫描当前目录（默认设置）
directory-browser.bat

# 限制扫描深度为3层
directory-browser.bat -d 3

# 只显示txt和log文件
directory-browser.bat -f "txt,log"

# 启用交互模式
directory-browser.bat -i
```

#### 组合参数
```cmd
# 深度限制 + 文件过滤 + 交互模式
directory-browser.bat -d 2 -f "txt,md,json" -i

# 显示隐藏文件，但不预览内容
directory-browser.bat -h true -p false
```

## 配置文件

脚本支持通过 `browser_config.ini` 配置文件自定义默认行为：

```ini
MAX_DEPTH=-1
SHOW_HIDDEN=false
PREVIEW_LINES=10
MAX_FILE_SIZE=1024
LOG_LEVEL=INFO
SHOW_SIZE=true
ENABLE_PREVIEW=true
INTERACTIVE_MODE=false
FILE_FILTER=
```

### 配置说明

| 配置项 | 类型 | 描述 |
|--------|------|------|
| `MAX_DEPTH` | 整数 | 最大遍历深度（-1表示无限制） |
| `SHOW_HIDDEN` | 布尔值 | 是否显示隐藏文件 |
| `PREVIEW_LINES` | 整数 | 文件预览显示的行数 |
| `MAX_FILE_SIZE` | 整数 | 预览文件的最大大小（KB） |
| `LOG_LEVEL` | 字符串 | 日志级别（DEBUG/INFO/WARNING/ERROR） |
| `SHOW_SIZE` | 布尔值 | 是否显示文件大小 |
| `ENABLE_PREVIEW` | 布尔值 | 是否启用内容预览 |
| `INTERACTIVE_MODE` | 布尔值 | 是否默认启用交互模式 |
| `FILE_FILTER` | 字符串 | 默认文件过滤器 |

## 支持的文件类型

### 文本文件预览
- `.txt` - 纯文本文件
- `.md` - Markdown文档  
- `.log` - 日志文件

### 配置文件预览
- `.ini` - 配置文件
- `.conf` - 配置文件
- `.cfg` - 配置文件

### 脚本文件预览
- `.bat` - 批处理脚本
- `.cmd` - 命令脚本
- `.ps1` - PowerShell脚本

### 数据文件预览
- `.json` - JSON数据
- `.xml` - XML文档
- `.csv` - CSV数据

### 代码文件预览
- `.py` - Python代码
- `.js` - JavaScript代码
- `.html` - HTML文档
- `.css` - CSS样式表
- `.java` - Java代码
- `.cpp` - C++代码
- `.c` - C代码

## 交互模式

在交互模式下，可以使用以下命令：

| 命令 | 功能 |
|------|------|
| `h` / `help` | 显示帮助信息 |
| `s` / `search` | 搜索文件名 |
| `f` / `filter` | 配置文件过滤器 |
| `r` / `rescan` | 重新扫描目录 |
| `q` / `quit` | 退出程序 |

## 输出示例

```
=========================================
    Directory Browser v1.0
=========================================

扫描目录: C:\MyProject
最大深度: 3

├── config.json
     大小: 245 B | 修改时间: 2024-01-15 10:30:22
     --- 内容预览 ---
     {
       "name": "项目配置",
       "version": "1.0",
       [...]

├── README.md
     大小: 1.2 KB | 修改时间: 2024-01-15 09:15:33
     --- 内容预览 ---
     # 项目说明
     
     这是一个示例项目...
     [...]

├── [DIR] src
│   ├── main.py
│   │    大小: 2.5 KB | 修改时间: 2024-01-15 11:45:12
│   │    --- 内容预览 ---
│   │    #!/usr/bin/env python3
│   │    import os
│   │    [...]
│   └── [DIR] utils
│       └── helper.py

=========================================
扫描完成统计
=========================================
总文件数: 15
总目录数: 3
扫描路径: C:\MyProject
```

## 性能说明

- 支持大型目录结构（建议单次扫描不超过10000个文件）
- 预览功能仅处理小于1MB的文件
- 使用临时文件确保排序和稳定性
- 支持中断和恢复操作

## 故障排除

### 常见问题

**Q: 脚本运行时出现乱码**
A: 确保控制台支持UTF-8编码，脚本会自动设置编码

**Q: 某些文件无法预览**
A: 检查文件权限，确保当前用户有读取权限

**Q: 扫描速度较慢**
A: 使用 `-d` 参数限制扫描深度，或使用 `-f` 参数过滤文件类型

**Q: 交互模式无响应**
A: 按 `Ctrl+C` 强制退出，检查输入命令是否正确

### 日志文件

所有操作记录保存在 `browser.log` 文件中，包含：
- 程序启动和结束时间
- 扫描的目录路径
- 错误和警告信息
- 用户操作记录

## 版本历史

### v1.0 (当前版本)
- 初始版本发布
- 实现基本的目录浏览功能
- 支持文件内容预览
- 添加交互模式
- 完善配置选项

## 贡献与反馈

如果您发现问题或有改进建议，欢迎：
- 报告bug和问题
- 提出功能改进建议
- 分享使用经验

## 许可证

本脚本基于MIT许可证发布，可自由使用和修改。

---

**注意**: 本脚本仅供浏览和分析使用，不会修改任何文件内容。使用时请确保有足够的权限访问目标目录。